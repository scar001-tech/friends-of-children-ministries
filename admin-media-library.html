<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Admin - Media Library">
    <title>Media Library | Admin Dashboard</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Outfit:wght@400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="index.css">

    <style>
        .admin-header {
            background: var(--gradient-primary);
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .admin-nav {
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 var(--spacing-md);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .admin-logo {
            color: white;
            font-family: var(--font-display);
            font-size: 1.5rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .admin-badge {
            background: rgba(255, 255, 255, 0.2);
            padding: 0.25rem 0.75rem;
            border-radius: var(--radius-full);
            font-size: 0.75rem;
        }

        .admin-actions {
            display: flex;
            gap: 1rem;
        }

        .btn-nav {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 0.5rem 1rem;
            border-radius: var(--radius-md);
            font-size: 0.9rem;
            cursor: pointer;
            text-decoration: none;
            transition: all var(--transition-base);
        }

        .btn-nav:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .admin-container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 2rem var(--spacing-md);
        }

        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .page-header h1 {
            color: var(--text-primary);
            font-size: 2rem;
        }

        .upload-area {
            background: var(--bg-primary);
            border: 2px dashed var(--border-color);
            border-radius: var(--radius-xl);
            padding: 3rem;
            text-align: center;
            margin-bottom: 2rem;
            transition: all var(--transition-base);
            cursor: pointer;
        }

        .upload-area:hover,
        .upload-area.dragover {
            border-color: var(--primary-color);
            background: var(--bg-secondary);
        }

        .upload-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        .upload-area h3 {
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .upload-area p {
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }

        .btn-primary {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            background: var(--gradient-button);
            color: white;
            border: none;
            border-radius: var(--radius-lg);
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-base);
            box-shadow: var(--shadow-gold);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
        }

        .filter-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .filter-tab {
            padding: 0.5rem 1rem;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-full);
            cursor: pointer;
            font-size: 0.9rem;
            transition: all var(--transition-base);
        }

        .filter-tab.active {
            background: var(--gradient-button);
            color: white;
            border-color: transparent;
        }

        .media-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1.5rem;
        }

        .media-card {
            background: var(--bg-primary);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
            overflow: hidden;
            transition: all var(--transition-base);
        }

        .media-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }

        .media-preview {
            height: 150px;
            background: var(--bg-tertiary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 4rem;
            position: relative;
        }

        .media-type-badge {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            padding: 0.25rem 0.5rem;
            background: rgba(0, 0, 0, 0.6);
            color: white;
            border-radius: var(--radius-sm);
            font-size: 0.7rem;
            text-transform: uppercase;
        }

        .media-info {
            padding: 1rem;
        }

        .media-name {
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .media-meta {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .media-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.75rem;
        }

        .btn-action {
            flex: 1;
            padding: 0.5rem;
            border-radius: var(--radius-md);
            font-size: 0.8rem;
            cursor: pointer;
            border: none;
            transition: all var(--transition-fast);
        }

        .btn-copy {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .btn-copy:hover {
            background: var(--primary-color);
            color: white;
        }

        .btn-delete {
            background: #fee2e2;
            color: #dc2626;
        }

        .btn-delete:hover {
            background: #dc2626;
            color: white;
        }

        .storage-info {
            background: var(--bg-primary);
            border-radius: var(--radius-xl);
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
        }

        .storage-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.75rem;
        }

        .storage-bar {
            height: 8px;
            background: var(--bg-tertiary);
            border-radius: var(--radius-full);
            overflow: hidden;
        }

        .storage-fill {
            height: 100%;
            background: var(--gradient-button);
            border-radius: var(--radius-full);
            transition: width 0.5s ease;
        }

        .alert {
            padding: 1rem;
            border-radius: var(--radius-md);
            margin-bottom: 1rem;
            display: none;
        }

        .alert-success {
            background: #dcfce7;
            color: #166534;
        }

        .alert.show {
            display: block;
        }

        .empty-state {
            text-align: center;
            padding: 4rem;
            color: var(--text-muted);
        }

        .empty-state span {
            font-size: 4rem;
            display: block;
            margin-bottom: 1rem;
        }

        @media (max-width: 600px) {
            .media-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>

<body>
    <!-- Admin Header -->
    <header class="admin-header">
        <nav class="admin-nav">
            <div class="admin-logo">
                <span>Friends of Children Ministries</span>
                <span class="admin-badge">ADMIN</span>
            </div>
            <div class="admin-actions">
                <a href="admin.html" class="btn-nav">← Dashboard</a>
                <button class="btn-nav" onclick="logout()">Logout</button>
            </div>
        </nav>
    </header>

    <!-- Main Content -->
    <main class="admin-container">
        <div class="page-header">
            <h1>Media Library</h1>
        </div>

        <div id="alertBox" class="alert alert-success"></div>

        <!-- Storage Info -->
        <div class="storage-info">
            <div class="storage-header">
                <span style="font-weight: 500; color: var(--text-primary);">Storage Used</span>
                <span style="color: var(--text-secondary);"><strong id="storageUsed">2.4 GB</strong> of 10 GB</span>
            </div>
            <div class="storage-bar">
                <div class="storage-fill" style="width: 24%;"></div>
            </div>
        </div>

        <!-- Upload Area -->
        <div class="upload-area" id="uploadArea" onclick="document.getElementById('fileInput').click();">
            <div class="upload-icon">↑</div>
            <h3>Drag & Drop Files Here</h3>
            <p>or click to browse your computer</p>
            <button class="btn-primary"
                onclick="event.stopPropagation(); document.getElementById('fileInput').click();">Choose
                Files</button>
            <input type="file" id="fileInput" multiple hidden accept="image/*,video/*,audio/*">
            <p style="margin-top: 1rem; font-size: 0.85rem;">Supported: Images (JPG, PNG, GIF), Videos (MP4, WebM),
                Audio (MP3, WAV)</p>
        </div>

        <!-- Filter Tabs -->
        <div class="filter-tabs">
            <button class="filter-tab active" data-filter="all">All Files</button>
            <button class="filter-tab" data-filter="image">Images</button>
            <button class="filter-tab" data-filter="video">Videos</button>
            <button class="filter-tab" data-filter="audio">Audio</button>
        </div>

        <!-- Media Grid -->
        <div class="media-grid" id="mediaGrid">
            <!-- Media items loaded dynamically -->
        </div>
    </main>

    <script>
        // Authentication check
        if (sessionStorage.getItem('adminLoggedIn') !== 'true') {
            window.location.href = 'admin-login.html';
        }

        // Sample media data
        let mediaFiles = [
            { id: 1, name: "creation-banner.jpg", type: "image", size: "2.4 MB", date: "Dec 1, 2024", icon: "IMG" },
            { id: 2, name: "jesus-loves-children.jpg", type: "image", size: "1.8 MB", date: "Nov 28, 2024", icon: "IMG" },
            { id: 3, name: "bible-story-intro.mp4", type: "video", size: "45.2 MB", date: "Nov 25, 2024", icon: "VID" },
            { id: 4, name: "worship-song.mp3", type: "audio", size: "5.6 MB", date: "Nov 20, 2024", icon: "AUD" },
            { id: 5, name: "noahs-ark.png", type: "image", size: "3.1 MB", date: "Nov 15, 2024", icon: "IMG" },
            { id: 6, name: "good-samaritan.mp4", type: "video", size: "52.8 MB", date: "Nov 10, 2024", icon: "VID" },
            { id: 7, name: "prayer-background.mp3", type: "audio", size: "4.2 MB", date: "Nov 5, 2024", icon: "AUD" },
            { id: 8, name: "lesson-thumbnail.jpg", type: "image", size: "890 KB", date: "Nov 1, 2024", icon: "IMG" }
        ];

        let currentFilter = 'all';

        // Render media grid
        function renderMedia(data = mediaFiles) {
            const grid = document.getElementById('mediaGrid');
            const filtered = currentFilter === 'all' ? data : data.filter(m => m.type === currentFilter);

            if (filtered.length === 0) {
                grid.innerHTML = `
                    <div class="empty-state" style="grid-column: 1 / -1;">
                        <span>No files</span>
                        <p>No ${currentFilter} files found</p>
                    </div>
                `;
                return;
            }

            grid.innerHTML = filtered.map(file => `
                <div class="media-card" data-id="${file.id}">
                    <div class="media-preview">
                        ${file.icon}
                        <span class="media-type-badge">${file.type}</span>
                    </div>
                    <div class="media-info">
                        <div class="media-name" title="${file.name}">${file.name}</div>
                        <div class="media-meta">${file.size} • ${file.date}</div>
                        <div class="media-actions">
                            <button class="btn-action btn-copy" onclick="copyLink(${file.id})">Copy URL</button>
                            <button class="btn-action btn-delete" onclick="deleteMedia(${file.id})">Delete</button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Filter tabs
        document.querySelectorAll('.filter-tab').forEach(tab => {
            tab.addEventListener('click', function () {
                document.querySelectorAll('.filter-tab').forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                currentFilter = this.dataset.filter;
                renderMedia();
            });
        });

        // Upload handling
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');

        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            handleFiles(e.dataTransfer.files);
        });

        fileInput.addEventListener('change', (e) => {
            handleFiles(e.target.files);
        });

        function handleFiles(files) {
            Array.from(files).forEach(file => {
                const type = file.type.startsWith('image') ? 'image' :
                    file.type.startsWith('video') ? 'video' :
                        file.type.startsWith('audio') ? 'audio' : 'file';

                const icon = type === 'image' ? 'IMG' : type === 'video' ? 'VID' : type === 'audio' ? 'AUD' : 'FILE';

                const newFile = {
                    id: Date.now() + Math.random(),
                    name: file.name,
                    type: type,
                    size: formatSize(file.size),
                    date: new Date().toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' }),
                    icon: icon
                };

                mediaFiles.unshift(newFile);
            });

            showAlert(`${files.length} file(s) uploaded successfully!`);
            renderMedia();
        }

        function formatSize(bytes) {
            if (bytes < 1024) return bytes + ' B';
            if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
            return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
        }

        function copyLink(id) {
            const file = mediaFiles.find(m => m.id === id);
            if (file) {
                navigator.clipboard.writeText(`https://sundayschoollessons.org/media/${file.name}`);
                showAlert('Link copied to clipboard!');
            }
        }

        function deleteMedia(id) {
            if (confirm('Are you sure you want to delete this file?')) {
                mediaFiles = mediaFiles.filter(m => m.id !== id);
                showAlert('File deleted successfully!');
                renderMedia();
            }
        }

        function showAlert(message) {
            const alert = document.getElementById('alertBox');
            alert.textContent = message;
            alert.classList.add('show');
            setTimeout(() => alert.classList.remove('show'), 3000);
        }

        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                sessionStorage.removeItem('adminLoggedIn');
                sessionStorage.removeItem('adminUsername');
                window.location.href = 'admin-login.html';
            }
        }

        // Initialize
        renderMedia();
    </script>
</body>

</html>